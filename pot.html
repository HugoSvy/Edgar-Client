<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <title>Données du Capteur</title>
    <style>
      table {
        margin: 150px auto; /* Centre le tableau horizontalement */
        width: 90%;
        border-collapse: collapse;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: table; /* Assure que le tableau est bien centré */
      }

      th,
      td {
        padding: 12px 16px;
        border: 1px solid #ddd;
        text-align: left;
        font-size: 16px;
      }

      th {
        background-color: #f8f9fa;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      tr:hover {
        background-color: #f1f1f1;
        transition: background-color 0.3s ease-in-out;
      }
    </style>
    <link rel="stylesheet" href="./styles/styles_vitrine.css" />
  </head>
  <body>
    <header class="fixed w-full bg-white/90 backdrop-blur-sm z-50 shadow-sm">
      <nav
        class="container mx-auto px-4 py-4 flex justify-between items-center"
      >
        <a href="./" class="text-2xl font-bold text-edgar-green">Edgar</a>
        <div class="space-x-6">
          <a href="./pot.html" class="hover:text-edgar-green transition-colors"
            >Pot</a
          >
          <a
            href="./debug.html"
            class="hover:text-edgar-green transition-colors"
            >Debugger</a
          >
          <a
            href="./index.html#features"
            class="hover:text-edgar-green transition-colors"
            >Fonctionnalités</a
          >
          <a
            href="./index.html#app"
            class="hover:text-edgar-green transition-colors"
            >Application</a
          >
          <a
            href="./index.html#faq"
            class="hover:text-edgar-green transition-colors"
            >FAQ</a
          >
        </div>
      </nav>
    </header>

    <h1>Données du Capteur</h1>
    <table id="sensorData">
      <thead>
        <tr>
          <th>Clé</th>
          <th>Valeur</th>
        </tr>
      </thead>
      <tbody>
        <!-- Les données seront insérées ici -->
      </tbody>
    </table>

    <script>
      async function fetchSensorData() {
        const url =
          "https://tolerant-namely-swift.ngrok-free.app/last_recherche2?device=7A2F6F";
        try {
          const response = await fetch(url, {
            headers: {
              "ngrok-skip-browser-warning": "1",
            },
          });
          if (!response.ok) {
            throw new Error(`Erreur HTTP : ${response.status}`);
          }
          const data = await response.json();
          displayData(data);
        } catch (error) {
          console.error(
            `Problème lors de la récupération des données : ${error.message}`
          );
        }
      }

      function displayData(data) {
        const tbody = document
          .getElementById("sensorData")
          .querySelector("tbody");
        tbody.innerHTML = "";
        for (const key in data) {
          if (data.hasOwnProperty(key)) {
            const row = document.createElement("tr");
            const keyCell = document.createElement("td");
            const valueCell = document.createElement("td");
            keyCell.textContent = key;
            valueCell.textContent = data[key];
            row.appendChild(keyCell);
            row.appendChild(valueCell);
            tbody.appendChild(row);
          }
        }
      }

      // Appel de la fonction pour récupérer et afficher les données
      fetchSensorData();
    </script>
  </body>
</html>
